<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <!-- ลิงก์ไปยังไฟล์ CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="login-page">
        <h2>Login Page</h2>
        <label for="username">Username:</label>
        <input type="text" id="username" placeholder="Enter Username">
        <br>
        <label for="password">Password:</label>
        <input type="password" id="password" placeholder="Enter Password">
        <br>
        <button id="login-btn" onclick="login()">Log in</button>
        <button id="request-btn" onclick="goToRequestForm()" disabled>Request Form</button>

        <p id="welcome-message"></p>
    </div>

    <!-- ลิงก์ไปยังไฟล์ JavaScript -->
    <script>
       let loggedInUsername = '';

// ฟังก์ชันสำหรับ Log in
function login() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    if (username && password) {
        fetch('/api/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        })
        .then(response => response.json())
        .then(data => {
            if (data.message === 'Login successful') {
                loggedInUsername = data.username; // รับชื่อผู้ใช้จาก back-end
                document.getElementById('welcome-message').innerText = `Welcome, ${loggedInUsername}`; // แสดงชื่อผู้ใช้
                document.getElementById('request-btn').disabled = false;  // เปิดใช้งานปุ่ม Request Form
            } else {
                alert('Invalid username or password');
            }
        })
        .catch(error => console.error('Error:', error));
    } else {
        alert('Please enter both username and password.');
    }
}
 // ฟังก์ชันสำหรับเปลี่ยนเส้นทางไปยังหน้า Request Form
 function goToRequestForm() {
        if (loggedInUsername) {
            localStorage.setItem('username', loggedInUsername);
            window.location.href = 'request.html';
        } else {
            alert('Please log in first.');
        }
    }
    </script>
</body>
</html>
